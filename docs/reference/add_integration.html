<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Integration models — add_integration • pseval</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Integration models — add_integration"><meta name="description" content="Add integration model to a psdesign object"><meta property="og:description" content="Add integration model to a psdesign object"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">pseval</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.3.3</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/introduction.html">Introduction to Principal Surrogate Evaluation in R</a></li>
  </ul></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/sachsmc/pseval/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Integration models</h1>
      <small class="dont-index">Source: <a href="https://github.com/sachsmc/pseval/blob/HEAD/R/pseval-constructors.R" class="external-link"><code>R/pseval-constructors.R</code></a></small>
      <div class="d-none name"><code>add_integration.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Add integration model to a psdesign object</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">add_integration</span><span class="op">(</span><span class="va">psdesign</span>, <span class="va">integration</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-psdesign">psdesign<a class="anchor" aria-label="anchor" href="#arg-psdesign"></a></dt>
<dd><p>A psdesign object</p></dd>


<dt id="arg-integration">integration<a class="anchor" aria-label="anchor" href="#arg-integration"></a></dt>
<dd><p>An integration object</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>This is a list of the available integration models. The fundamental problem in surrogate evaluation is that there are unobserved values of the counterfactual surrogate responses S(1). In the estimated maximum likelihood framework, for subjects missing the S(1) values, we use an auxiliary pre-treatment variable or set of variables W that is observed for every subject to estimate the distribution of S(1) | W. Typically, this W is a BIP. Then for each missing S(1), we integrate likelihood contributions over each non-missing S(1) given their value of W, and average over the contributions.</p>
<ul><li><p><a href="integrate_parametric.html">integrate_parametric</a> This is a parametric integration model that fits a linear model for the mean of S(1) | W and assumes a Gaussian distribution.</p></li>
<li><p><a href="integrate_bivnorm.html">integrate_bivnorm</a> This is another parametric integration model that assumes that S(1) and W are jointly normally distributed. The user must specify their mean, variances and correlation.</p></li>
<li><p><a href="integrate_nonparametric.html">integrate_nonparametric</a> This is a non-parametric integration model that is only valid for categorical S(1) and W. It uses the observed proportions to estimate the joint distribution of S(1), W.</p></li>
<li><p><a href="integrate_semiparametric.html">integrate_semiparametric</a> This is a semi-parametric model that uses the semi-parametric location scale model of Heagerty and Pepe (1999). Models are specified for the location of S(1) | W and the scale of S(1) | W. Then integrations are drawn from the empirical distribution of the residuals from that model, which are then transformed to the appropriate location and scale.</p></li>
</ul></div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">test</span> <span class="op">&lt;-</span> <span class="fu"><a href="psdesign.html">psdesign</a></span><span class="op">(</span><span class="fu"><a href="generate_example_data.html">generate_example_data</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">100</span><span class="op">)</span>, Z <span class="op">=</span> <span class="va">Z</span>, Y <span class="op">=</span> <span class="va">Y.obs</span>, S <span class="op">=</span> <span class="va">S.obs</span>, BIP <span class="op">=</span> <span class="va">BIP</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">add_integration</span><span class="op">(</span><span class="va">test</span>, <span class="fu"><a href="integrate_parametric.html">integrate_parametric</a></span><span class="op">(</span><span class="va">S.1</span> <span class="op">~</span> <span class="va">BIP</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Augmented data frame:  100  obs. by  6  variables. </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Z Y  S.1    S.0 cdfweights    BIP</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 0 1   NA -0.739          1 -0.891</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2 0 0   NA -0.113          1 -0.117</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3 0 0   NA -0.868          1 -0.942</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4 1 0 1.97     NA          1  1.116</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5 1 0 1.45     NA          1  0.470</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6 1 0 2.02     NA          1  0.861</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Empirical TE:  0.267 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Mapped variables: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 	 Z  -&gt;  Z </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 	 Y  -&gt;  Y.obs </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 	 S  -&gt;  S.obs </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 	 BIP  -&gt;  BIP </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Integration models: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 	 integration model for  S.1 :</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 		 integrate_parametric(formula = S.1 ~ BIP )</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Risk models: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 	None present, see ?add_riskmodel for information on risk models.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 	No estimates present, see ?ps_estimate.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 	No bootstraps present, see ?ps_bootstrap.</span>
<span class="r-in"><span><span class="va">test</span> <span class="op">+</span> <span class="fu"><a href="integrate_parametric.html">integrate_parametric</a></span><span class="op">(</span><span class="va">S.1</span> <span class="op">~</span> <span class="va">BIP</span><span class="op">)</span>  <span class="co"># same as above</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Augmented data frame:  100  obs. by  6  variables. </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Z Y  S.1    S.0 cdfweights    BIP</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 0 1   NA -0.739          1 -0.891</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2 0 0   NA -0.113          1 -0.117</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3 0 0   NA -0.868          1 -0.942</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4 1 0 1.97     NA          1  1.116</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5 1 0 1.45     NA          1  0.470</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6 1 0 2.02     NA          1  0.861</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Empirical TE:  0.267 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Mapped variables: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 	 Z  -&gt;  Z </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 	 Y  -&gt;  Y.obs </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 	 S  -&gt;  S.obs </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 	 BIP  -&gt;  BIP </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Integration models: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 	 integration model for  S.1 :</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 		 integrate_parametric(formula = S.1 ~ BIP )</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Risk models: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 	None present, see ?add_riskmodel for information on risk models.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 	No estimates present, see ?ps_estimate.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 	No bootstraps present, see ?ps_bootstrap.</span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Michael C Sachs, Erin E Gabriel.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.0.</p>
</div>

    </footer></div>





  </body></html>

